{"is_source_file": true, "format": "Python", "description": "Test suite for the weather API backend, using pytest and FastAPI's TestClient to test endpoints and mocking external API responses.", "external_files": ["src/api/main.py", "httpx", "pytest"], "external_methods": ["pytest.MonkeyPatch.setenv", "pytest.MonkeyPatch.delenv", "httpx.RequestError", "httpx.Request", "httpx.AsyncClient"], "published": ["test_get_weather_success", "test_missing_city_returns_400", "test_missing_api_key_returns_500", "test_city_not_found_returns_404", "test_upstream_network_error_returns_502", "teardown_module"], "classes": [{"name": "MockResponse", "description": "A mock HTTP response mimicking the behavior of responses from httpx, supports json serialization and error raising."}, {"name": "MockAsyncClient", "description": "A minimal mock of httpx.AsyncClient for testing purposes, supporting context management and simulated responses."}], "methods": [{"name": "Dict[str,Any] json(self)", "description": "Returns the JSON data; raises ValueError if _json_raises is True.", "scope": "MockResponse", "scopeKind": "class"}, {"name": "\"MockAsyncClient\" __aenter__(self)", "description": "Async context manager entry; returns self.", "scope": "MockAsyncClient", "scopeKind": "class"}, {"name": "None __aexit__(self, exc_type, exc, tb)", "description": "Async context manager exit; does nothing.", "scope": "MockAsyncClient", "scopeKind": "class"}, {"name": "MockResponse get(self, url: str, params: Dict[str, Any] | None = None)", "description": "Simulates an HTTP GET request, returning a predefined MockResponse or raising an error based on initialization parameters.", "scope": "MockAsyncClient", "scopeKind": "class"}, {"name": "__init__(self, response: MockResponse | None = None, raise_request_error: bool = False, timeout: float = 10.0)", "scope": "MockAsyncClient", "scopeKind": "class", "description": "unavailable"}, {"name": "__init__(self, status_code: int, json_data: Dict[str, Any] | None = None, json_raises: bool = False)", "scope": "MockResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "TestClient client()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "mock_async_client(*args, **kwargs)", "scope": "test_upstream_network_error_returns_502", "scopeKind": "function", "description": "unavailable"}, {"name": "None teardown_module()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None test_city_not_found_returns_404(monkeypatch: pytest.MonkeyPatch, client: TestClient)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None test_get_weather_success(monkeypatch: pytest.MonkeyPatch, client: TestClient)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None test_missing_api_key_returns_500(monkeypatch: pytest.MonkeyPatch, client: TestClient)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None test_missing_city_returns_400(client: TestClient)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None test_upstream_network_error_returns_502(monkeypatch: pytest.MonkeyPatch, client: TestClient)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["pytest.MonkeyPatch.setenv", "pytest.MonkeyPatch.delenv", "client.get", "client.post"], "search-terms": ["test_weather_endpoint", "mock_async_client", "FastAPI", "pytest", "httpx", "MockResponse", "MockAsyncClient", "test_get_weather_success", "test_missing_city_returns_400"], "state": 2, "file_id": 5, "knowledge_revision": 13, "git_revision": "", "ctags": [{"_type": "tag", "name": "MockAsyncClient", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^class MockAsyncClient:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "MockResponse", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^class MockResponse:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__aenter__", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^    async def __aenter__(self) -> \"MockAsyncClient\":$/", "language": "Python", "typeref": "typename:\"MockAsyncClient\"", "kind": "member", "signature": "(self)", "scope": "MockAsyncClient", "scopeKind": "class"}, {"_type": "tag", "name": "__aexit__", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^    async def __aexit__(self, exc_type, exc, tb) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, exc_type, exc, tb)", "scope": "MockAsyncClient", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^    def __init__(self, response: MockResponse | None = None, raise_request_error: bool = False, /", "language": "Python", "kind": "member", "signature": "(self, response: MockResponse | None = None, raise_request_error: bool = False, timeout: float = 10.0)", "scope": "MockAsyncClient", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^    def __init__(self, status_code: int, json_data: Dict[str, Any] | None = None, json_raises: b/", "language": "Python", "kind": "member", "signature": "(self, status_code: int, json_data: Dict[str, Any] | None = None, json_raises: bool = False)", "scope": "MockResponse", "scopeKind": "class"}, {"_type": "tag", "name": "client", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^def client() -> TestClient:$/", "language": "Python", "typeref": "typename:TestClient", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^    async def get(self, url: str, params: Dict[str, Any] | None = None) -> MockResponse:$/", "language": "Python", "typeref": "typename:MockResponse", "kind": "member", "signature": "(self, url: str, params: Dict[str, Any] | None = None)", "scope": "MockAsyncClient", "scopeKind": "class"}, {"_type": "tag", "name": "json", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^    def json(self) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self)", "scope": "MockResponse", "scopeKind": "class"}, {"_type": "tag", "name": "mock_async_client", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^    def mock_async_client(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "test_city_not_found_returns_404", "scopeKind": "function"}, {"_type": "tag", "name": "mock_async_client", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^    def mock_async_client(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "test_get_weather_success", "scopeKind": "function"}, {"_type": "tag", "name": "mock_async_client", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^    def mock_async_client(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "test_upstream_network_error_returns_502", "scopeKind": "function"}, {"_type": "tag", "name": "teardown_module", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^def teardown_module() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "test_city_not_found_returns_404", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^def test_city_not_found_returns_404(monkeypatch: pytest.MonkeyPatch, client: TestClient) -> None/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(monkeypatch: pytest.MonkeyPatch, client: TestClient)"}, {"_type": "tag", "name": "test_get_weather_success", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^def test_get_weather_success(monkeypatch: pytest.MonkeyPatch, client: TestClient) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(monkeypatch: pytest.MonkeyPatch, client: TestClient)"}, {"_type": "tag", "name": "test_missing_api_key_returns_500", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^def test_missing_api_key_returns_500(monkeypatch: pytest.MonkeyPatch, client: TestClient) -> Non/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(monkeypatch: pytest.MonkeyPatch, client: TestClient)"}, {"_type": "tag", "name": "test_missing_city_returns_400", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^def test_missing_city_returns_400(client: TestClient) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(client: TestClient)"}, {"_type": "tag", "name": "test_upstream_network_error_returns_502", "path": "/home/kavia/workspace/code-generation/weather-search-app-6692-6704/weather_backend/tests/test_weather_endpoint.py", "pattern": "/^def test_upstream_network_error_returns_502(monkeypatch: pytest.MonkeyPatch, client: TestClient)/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(monkeypatch: pytest.MonkeyPatch, client: TestClient)"}], "hash": "98e624ac9b0b8c1389dbb02a60b683c5", "format-version": 4, "code-base-name": "weather_backend", "filename": "weather_backend/tests/test_weather_endpoint.py", "revision_history": [{"13": ""}]}